(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{776:function(e,t,n){"use strict";n.r(t);var a=n(10),r=n.n(a),c=n(27),i=n.n(c),o=n(147),l=n.n(o),s=n(193),u=n.n(s),p=n(0),f=n.n(p),d=n(1),m=n.n(d),b=n(50),v=n(750),O=n(741),y=n(109),h=n(106),g=n(773),E=n(746),j=n(748),w=n(749),k=n(756),P=n(774),x=(n(60),n(755)),S=n.n(x),I=n(21),C=n(38),D=n(37);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=n(248),U=n.n(A),L=n(124),B=n.n(L),X=n(775),H=n(751),M=n(745);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=Object(p.memo)((function(e){var t=e.isOpen,n=e.toggleModal,a=e.block,c=e.blockServices,o=e.callback,s=Object(p.useState)([]),d=u()(s,2),m=d[0],b=d[1],v=Object(p.useState)([]),O=u()(v,2),y=O[0],g=O[1],k=Object(p.useState)(!1),P=u()(k,2),x=P[0],S=P[1];Object(p.useEffect)((function(){I()}),[]),Object(p.useEffect)((function(){var e=m.filter((function(e){if(!c.some((function(t){return t.nameService===e.nameService})))return e}));g(e)}),[c]);var I=function(){var e=l()(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a=void 0,C.a.getList(z({},a,{API:D.a.API+"/default-service/get-default-services"}));case 2:(t=e.sent)&&t.data&&t.data.data&&(n=t.data.data.defaultServices,b(n||[]));case 4:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=l()(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||"object"!==B()(t)){e.next=7;break}return S(!0),e.next=4,r={services:t},C.a.create(N({},r,{API:D.a.API+"/service/create"}));case 4:(a=e.sent)&&(a.data&&a.data.data?(E.a.success("Thêm Dịch vụ thành công!"),n(),o()):E.a.error("Thêm dịch vụ thất bại")),S(!1);case 7:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}();return f.a.createElement(X.a,{width:800,title:f.a.createElement("div",{className:"flex-row",style:{fontSize:20,color:"#08979c"}},f.a.createElement("i",{className:"icon-add"}),"  ",f.a.createElement("strong",null,"Thêm mới")),forceRender:!0,destroyOnClose:!1,getContainer:!1,visible:t,onOk:function(){n()},onCancel:function(){n()},footer:null},f.a.createElement(H.a,U()({onFinish:function(e){if(m.length>0){var t=e.services,n=m.filter((function(e){return t.some((function(t){return t===e.id}))})).map((function(e){return{nameService:e.nameService,price:e.price,idUnit:e.idUnit,description:e.description,idBlock:a.id}}));T(n)}},name:"services-create"},{labelCol:{xs:{span:24},md:{span:4}},wrapperCol:{xs:{span:24},md:{span:20}}},{initialValues:r()({},"services",[1,2])}),f.a.createElement(H.a.Item,{label:"Khu trọ/căn hộ",name:"nameBlock"},f.a.createElement("strong",null,a?a.nameBlock:null)),f.a.createElement(H.a.Item,{label:"Dịch vụ",name:"services"},f.a.createElement(M.a.Group,{style:{width:"50%"}},f.a.createElement(j.a,null,y.length>0?y.map((function(e){return f.a.createElement(w.a,{span:8,key:e.id},f.a.createElement(M.a,{value:e.id,style:{lineHeight:"32px"}},e.nameService))})):"Không có dịch vụ nào hiện tại"))),f.a.createElement(H.a.Item,{wrapperCol:{md:{span:8,offset:16}}},f.a.createElement("div",{className:"flex-row",style:{justifyContent:"flex-end"}},f.a.createElement(h.a,{onClick:function(){n()}},"Hủy bỏ")," ",f.a.createElement(h.a,{htmlType:"submit",type:"primary",loading:x},"Lưu lại")))))}));F.propTypes={callback:m.a.func};var R=F,V=n(752),K=n(777);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W=function(e){var t=H.a.useForm(),n=u()(t,1)[0],a=e.isOpen,r=e.toggleModal,c=e.callback,o=e.block,s=e.service,d=Object(p.useState)([]),m=u()(d,2),b=m[0],v=m[1],y=Object(p.useState)(!1),g=u()(y,2),k=g[0],P=g[1];Object(p.useEffect)((function(){x()}),[]),Object(p.useEffect)((function(){a&&n.setFieldsValue({price:s.price,idUnit:s.idUnit,description:s.description})}),[a]);var x=function(){var e=l()(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a=void 0,C.a.getList(J({},a,{API:D.a.API+"/unit/get-units"}));case 2:(t=e.sent)&&t.data&&t.data.data&&(n=t.data.data.units,v(n||[]));case 4:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=l()(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,a=Q({},t,{id:s.key}),C.a.update(N({},a,{API:D.a.API+"/service/update"}));case 3:(n=e.sent)&&n.data&&n.data.data&&(E.a.success("Cập nhật dịch vụ thành công"),r(),c()),P(!1);case 6:case"end":return e.stop()}var a}),e)})));return function(t){return e.apply(this,arguments)}}();return f.a.createElement(X.a,{width:800,title:f.a.createElement("div",{className:"flex-row",style:{fontSize:20,color:"#08979c"}},f.a.createElement("i",{className:"icon-createmode_editedit"}),"  ",f.a.createElement("strong",null,"Chỉnh sửa")),forceRender:!0,destroyOnClose:!1,getContainer:!1,visible:a,onOk:function(){r()},onCancel:function(){r()},footer:null},f.a.createElement(H.a,U()({},{labelCol:{xs:{span:24},md:{span:5}},wrapperCol:{xs:{span:24},md:{span:19}}},{name:"modal-update",form:n,onFinish:function(e){S(e)}}),f.a.createElement(H.a.Item,{label:"Tên khu trọ/căn hộ"},f.a.createElement("strong",null,o?o.nameBlock:null)),f.a.createElement(H.a.Item,{label:"Tên dịch vụ"},f.a.createElement("strong",null,s?s.nameService:null)),f.a.createElement(H.a.Item,{label:"Mô tả",name:"description"},f.a.createElement(V.a.TextArea,{placeholder:"Nhập mô tả"})),f.a.createElement(j.a,null,f.a.createElement(w.a,{xs:{span:24},md:{span:11,offset:1}},f.a.createElement(H.a.Item,{label:"Đơn giá",name:"price",rules:[{required:!0,message:"Vui lòng nhập đơn giá!"}]},f.a.createElement(K.a,{placeholder:"Nhập đơn giá",style:{width:200},formatter:function(e){return"₫ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\₫\s?|(,*)/g,"")}}))),f.a.createElement(w.a,{xs:{span:24},md:{span:12}},f.a.createElement(H.a.Item,{label:"Đơn vị",name:"idUnit"},f.a.createElement(O.a,null,b.length>0?b.map((function(e){return f.a.createElement(O.a.Option,{key:e.id,value:e.id},e.name)})):null)))),f.a.createElement(H.a.Item,{wrapperCol:{md:{span:8,offset:16}}},f.a.createElement("div",{className:"flex-row",style:{justifyContent:"flex-end"}},f.a.createElement(h.a,{onClick:function(){r()}},"Hủy bỏ")," ",f.a.createElement(h.a,{htmlType:"submit",type:"primary",loading:k},"Lưu lại")))))};W.propTypes={isOpen:m.a.bool.isRequired,service:m.a.object,block:m.a.object},W.defaultProps={isOpen:!1,service:{},block:{}};var Y=W;function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=v.a.Title,te=O.a.Option,ne=function(e){var t=e.layout,n=e.blocks,a=Object(p.useState)(null),r=u()(a,2),c=r[0],o=r[1],s=Object(p.useState)([]),d=u()(s,2),m=d[0],b=d[1],v=Object(p.useState)(!1),x=u()(v,2),I=x[0],T=x[1],A=Object(p.useState)([]),U=u()(A,2),L=U[0],B=U[1],X=Object(p.useState)(!1),H=u()(X,2),M=H[0],_=H[1],z=Object(p.useState)({isOpen:!1,serviceEdited:{}}),F=u()(z,2),V=F[0],K=F[1],q={selectedRowKeys:m,onChange:function(e){b(e)}},J=[{title:"",dataIndex:"edit",key:"edit",width:100,render:function(e){return f.a.createElement("div",{className:"flex-row-center"},f.a.createElement(y.a,{title:"Sửa"},f.a.createElement(h.a,{onClick:function(){return W(e)},className:"flex-row-center",size:"small",shape:"circle"},f.a.createElement("i",{className:"icon-createmode_editedit"}))),"  ",f.a.createElement(y.a,{title:"Xóa"},f.a.createElement(g.a,{title:"Bạn muốn xóa dịch vụ này?",onConfirm:function(){return Q(e)},okText:"Xóa",cancelText:"Hủy"},f.a.createElement(h.a,{className:"flex-row-center",size:"small",type:"danger",shape:"circle"},f.a.createElement("i",{className:"icon-highlight_remove"})))))}},{title:"Tên dịch vụ",dataIndex:"nameService",key:"nameService"},{title:"Đơn giá",dataIndex:"price",key:"price",render:function(e){return f.a.createElement("div",null,S()(e).format("0,0.00")," vnđ")}},{title:"Đơn vị",dataIndex:"nameUnit",key:"nameUnit"},{title:"Mô tả",dataIndex:"description",key:"description"}];Object(p.useEffect)((function(){t({type:"path",value:"services"})}),[]),Object(p.useEffect)((function(){c&&G()}),[c]),Object(p.useEffect)((function(){if(n.length>0){var e=n.some((function(e){return e.id===+localStorage.getItem("blockSelected")}));if(localStorage.getItem("blockSelected")&&e){var t=localStorage.getItem("blockSelected");o(+t)}else o(n[0].id)}}),[n]);var G=function(){var e=l()(i.a.mark((function e(){var t,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),e.next=3,r={idBlock:c},C.a.getList(N({},r,{API:D.a.API+"/service/get-services"}));case 3:(t=e.sent)&&t.data&&t.data.data&&(n=t.data.data.services,a=n.map((function(e){return{key:e.id,edit:e.id,idUnit:e.idUnit,nameService:e.nameService,price:e.price,nameUnit:e.nameUnit,description:e.description}})),B(a||[])),T(!1);case 6:case"end":return e.stop()}var r}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=l()(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a={id:t},C.a.del(N({},a,{API:D.a.API+"/service/delete"}));case 2:(n=e.sent)&&(n.data&&n.data.data?(E.a.success("Xóa dịch vụ thành công!"),G()):E.a.error("Xóa dịch vụ thất bại"));case 4:case"end":return e.stop()}var a}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(e){if(e){var t=L.find((function(t){return t.key===e}));K($({},V,{isOpen:!0,serviceEdited:t}))}},Z=function(){var e=l()(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n={servicesId:m},C.a.create(N({},n,{API:D.a.API+"/service/delete-all"}));case 2:(t=e.sent)&&(t.data&&t.data.data?(E.a.success("Xóa thành công"),b([]),G()):E.a.error("Xóa thất bại"));case 4:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}}();return f.a.createElement("div",{style:{padding:10}},f.a.createElement(j.a,null,f.a.createElement(w.a,{xs:{span:24,offset:0},md:{span:12,offset:0}},f.a.createElement(ee,{level:4},"QUẢN LÝ DỊCH VỤ")),f.a.createElement(w.a,{xs:{span:24,offset:0},md:{span:12,offset:0},className:"flex-row",style:{justifyContent:"flex-end"}},f.a.createElement(O.a,{showSearch:!0,value:c,style:{width:200},placeholder:"Chọn khu trọ",onChange:function(e){localStorage.setItem("blockSelected",e),o(e)},optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map((function(e){return f.a.createElement(te,{key:e.id,value:e.id},e.nameBlock)}))))),f.a.createElement(j.a,{style:{marginTop:20}},f.a.createElement(w.a,{xs:{span:24},md:{span:24},className:"flex-row",style:{justifyContent:"flex-end"}},f.a.createElement(h.a,{disabled:!(n.length>0),type:"primary",className:"flex-row",onClick:function(){_(!0)}},f.a.createElement("i",{className:"icon-add_circle_outlinecontrol_point"}),"   Thêm mới"),"  ",f.a.createElement(g.a,{disabled:!(m.length>0),placement:"bottom",title:"Bạn có muốn xóa ".concat(m.length," dịch vụ này?"),okText:"Xóa",onConfirm:Z,cancelText:"Hủy"},f.a.createElement(h.a,{disabled:!(m.length>0),type:"danger"},f.a.createElement("i",{className:"icon-delete"}),"   Xóa nhiều")))),f.a.createElement(k.a,{spinning:I,tip:"Loading..."},f.a.createElement(j.a,{style:{paddingTop:"10px"}},f.a.createElement(P.a,{size:"small",rowSelection:q,style:{width:"100%"},columns:J,dataSource:L}))),f.a.createElement(R,{isOpen:M,toggleModal:function(){_(!M)},block:n.find((function(e){return e.id===c})),blockServices:L,callback:function(){G()}}),f.a.createElement(Y,{isOpen:V.isOpen,service:V.serviceEdited,block:n.find((function(e){return e.id===c})),toggleModal:function(){K($({},V,{isOpen:!V.isOpen}))},callback:function(){G()}}))};ne.propTypes={};var ae={layout:I.c};t.default=Object(b.b)((function(e){return{blocks:e.Layouts.layoutReducer.blocks}}),ae)(ne)}}]);
//# sourceMappingURL=6.js.map