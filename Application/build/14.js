(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{930:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return d}));var r=n(14),a=n.n(r),c=n(52),i=n(51);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e){return c.a.create(l(l({},e),{},{API:i.a.API+"/service/create"}))}function u(e){return c.a.getList(l(l({},e),{},{API:i.a.API+"/service/get-services"}))}function p(e){return c.a.del(l(l({},e),{},{API:i.a.API+"/service/delete"}))}function f(e){return c.a.create(l(l({},e),{},{API:i.a.API+"/service/delete-all"}))}function d(e){return c.a.update(l(l({},e),{},{API:i.a.API+"/service/update"}))}},991:function(e,t,n){"use strict";n.r(t);var r=n(14),a=n.n(r),c=n(39),i=n.n(c),o=n(172),l=n.n(o),s=n(147),u=n.n(s),p=n(0),f=n.n(p),d=n(54),m=n.n(d),b=n(61),v=n(784),O=n(773),y=n(160),h=n(104),g=n(994),E=n(374),j=n(781),w=n(782),k=n(775),P=n(987),x=(n(71),n(922)),S=n.n(x),I=n(30),C=n(930),D=n(277),T=n.n(D),N=n(92),A=n.n(N),U=n(989),L=n(783),B=n(769),X=n(52),H=n(51);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=Object(p.memo)((function(e){var t=e.isOpen,n=e.toggleModal,r=e.block,c=e.blockServices,o=e.callback,s=Object(p.useState)([]),d=u()(s,2),m=d[0],b=d[1],v=Object(p.useState)([]),O=u()(v,2),y=O[0],g=O[1],k=Object(p.useState)(!1),P=u()(k,2),x=P[0],S=P[1];Object(p.useEffect)((function(){I()}),[]),Object(p.useEffect)((function(){var e=m.filter((function(e){if(!c.some((function(t){return t.nameService===e.nameService})))return e}));g(e)}),[c]);var I=function(){var e=l()(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r=void 0,X.a.getList(_(_({},r),{},{API:H.a.API+"/default-service/get-default-services"}));case 2:(t=e.sent)&&t.data&&t.data.data&&(n=t.data.data.defaultServices,b(n||[]));case 4:case"end":return e.stop()}var r}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=l()(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||"object"!==A()(t)){e.next=7;break}return S(!0),e.next=4,C.a({services:t});case 4:(r=e.sent)&&(r.data&&r.data.data?(E.a.success("Thêm Dịch vụ thành công!"),n(),o()):E.a.error("Thêm dịch vụ thất bại")),S(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return f.a.createElement(U.a,{width:800,title:f.a.createElement("div",{className:"flex-row",style:{fontSize:20,color:"#08979c"}},f.a.createElement("i",{className:"icon-add"}),"  ",f.a.createElement("strong",null,"Thêm mới")),forceRender:!0,destroyOnClose:!1,getContainer:!1,visible:t,onOk:function(){n()},onCancel:function(){n()},footer:null},f.a.createElement(L.a,T()({onFinish:function(e){if(m.length>0){var t=e.services,n=m.filter((function(e){return t.some((function(t){return t===e.id}))})).map((function(e){return{nameService:e.nameService,price:e.price,idUnit:e.idUnit,description:e.description,idBlock:r.id}}));D(n)}},name:"services-create"},{labelCol:{xs:{span:24},md:{span:4}},wrapperCol:{xs:{span:24},md:{span:20}}},{initialValues:a()({},"services",[1,2])}),f.a.createElement(L.a.Item,{label:"Khu trọ/căn hộ",name:"nameBlock"},f.a.createElement("strong",null,r?r.nameBlock:null)),f.a.createElement(L.a.Item,{label:"Dịch vụ",name:"services"},f.a.createElement(B.a.Group,{style:{width:"50%"}},f.a.createElement(j.a,null,y.length>0?y.map((function(e){return f.a.createElement(w.a,{span:8,key:e.id},f.a.createElement(B.a,{value:e.id,style:{lineHeight:"32px"}},e.nameService))})):"Không có dịch vụ nào hiện tại"))),f.a.createElement(L.a.Item,{wrapperCol:{md:{span:8,offset:16}}},f.a.createElement("div",{className:"flex-row",style:{justifyContent:"flex-end"}},f.a.createElement(h.a,{onClick:function(){n()}},"Hủy bỏ")," ",f.a.createElement(h.a,{htmlType:"submit",type:"primary",loading:x},"Lưu lại")))))}));z.propTypes={callback:m.a.func};var F=z,R=n(776),V=n(940);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(e){var t=L.a.useForm(),n=u()(t,1)[0],r=e.isOpen,a=e.toggleModal,c=e.callback,o=e.block,s=e.service,d=Object(p.useState)([]),m=u()(d,2),b=m[0],v=m[1],y=Object(p.useState)(!1),g=u()(y,2),k=g[0],P=g[1];Object(p.useEffect)((function(){x()}),[]),Object(p.useEffect)((function(){r&&n.setFieldsValue({price:s.price,idUnit:s.idUnit,description:s.description})}),[r]);var x=function(){var e=l()(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r=void 0,X.a.getList(q(q({},r),{},{API:H.a.API+"/unit/get-units"}));case 2:(t=e.sent)&&t.data&&t.data.data&&(n=t.data.data.units,v(n||[]));case 4:case"end":return e.stop()}var r}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=l()(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,C.e(G(G({},t),{},{id:s.key}));case 3:(n=e.sent)&&n.data&&n.data.data&&(E.a.success("Cập nhật dịch vụ thành công"),a(),c()),P(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return f.a.createElement(U.a,{width:800,title:f.a.createElement("div",{className:"flex-row",style:{fontSize:20,color:"#08979c"}},f.a.createElement("i",{className:"icon-createmode_editedit"}),"  ",f.a.createElement("strong",null,"Chỉnh sửa")),forceRender:!0,destroyOnClose:!1,getContainer:!1,visible:r,onOk:function(){a()},onCancel:function(){a()},footer:null},f.a.createElement(L.a,T()({},{labelCol:{xs:{span:24},md:{span:5}},wrapperCol:{xs:{span:24},md:{span:19}}},{name:"modal-update",form:n,onFinish:function(e){S(e)}}),f.a.createElement(L.a.Item,{label:"Tên khu trọ/căn hộ"},f.a.createElement("strong",null,o?o.nameBlock:null)),f.a.createElement(L.a.Item,{label:"Tên dịch vụ"},f.a.createElement("strong",null,s?s.nameService:null)),f.a.createElement(L.a.Item,{label:"Mô tả",name:"description"},f.a.createElement(R.a.TextArea,{placeholder:"Nhập mô tả"})),f.a.createElement(j.a,null,f.a.createElement(w.a,{xs:{span:24},md:{span:11,offset:1}},f.a.createElement(L.a.Item,{label:"Đơn giá",name:"price",rules:[{required:!0,message:"Vui lòng nhập đơn giá!"}]},f.a.createElement(V.a,{placeholder:"Nhập đơn giá",style:{width:200},formatter:function(e){return"₫ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\₫\s?|(,*)/g,"")}}))),f.a.createElement(w.a,{xs:{span:24},md:{span:12}},f.a.createElement(L.a.Item,{label:"Đơn vị",name:"idUnit"},f.a.createElement(O.a,null,b.length>0?b.map((function(e){return f.a.createElement(O.a.Option,{key:e.id,value:e.id},e.name)})):null)))),f.a.createElement(L.a.Item,{wrapperCol:{md:{span:8,offset:16}}},f.a.createElement("div",{className:"flex-row",style:{justifyContent:"flex-end"}},f.a.createElement(h.a,{onClick:function(){a()}},"Hủy bỏ")," ",f.a.createElement(h.a,{htmlType:"submit",type:"primary",loading:k},"Lưu lại")))))};Q.propTypes={isOpen:m.a.bool.isRequired,service:m.a.object,block:m.a.object},Q.defaultProps={isOpen:!1,service:{},block:{}};var W=Q;function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=v.a.Title,ee=O.a.Option,te=function(e){var t=e.layout,n=e.blocks,r=Object(p.useState)(null),a=u()(r,2),c=a[0],o=a[1],s=Object(p.useState)([]),d=u()(s,2),m=d[0],b=d[1],v=Object(p.useState)(!1),x=u()(v,2),I=x[0],D=x[1],T=Object(p.useState)([]),N=u()(T,2),A=N[0],U=N[1],L=Object(p.useState)(!1),B=u()(L,2),X=B[0],H=B[1],M=Object(p.useState)({isOpen:!1,serviceEdited:{}}),_=u()(M,2),z=_[0],R=_[1],V={selectedRowKeys:m,onChange:function(e){b(e)}},K=[{title:"",dataIndex:"edit",key:"edit",width:100,render:function(e){return f.a.createElement("div",{className:"flex-row-center"},f.a.createElement(y.a,{title:"Sửa"},f.a.createElement(h.a,{onClick:function(){return G(e)},className:"flex-row-center",size:"small",shape:"circle"},f.a.createElement("i",{className:"icon-createmode_editedit"}))),"  ",f.a.createElement(y.a,{title:"Xóa"},f.a.createElement(g.a,{title:"Bạn muốn xóa dịch vụ này?",onConfirm:function(){return J(e)},okText:"Xóa",cancelText:"Hủy"},f.a.createElement(h.a,{className:"flex-row-center",size:"small",type:"danger",shape:"circle"},f.a.createElement("i",{className:"icon-highlight_remove"})))))}},{title:"Tên dịch vụ",dataIndex:"nameService",key:"nameService"},{title:"Đơn giá",dataIndex:"price",key:"price",render:function(e){return f.a.createElement("div",null,S()(e).format("0,0.00")," vnđ")}},{title:"Đơn vị",dataIndex:"nameUnit",key:"nameUnit"},{title:"Mô tả",dataIndex:"description",key:"description"}];Object(p.useEffect)((function(){t({type:"path",value:"services"})}),[]),Object(p.useEffect)((function(){c&&q()}),[c]),Object(p.useEffect)((function(){if(n.length>0){var e=n.some((function(e){return e.id===+localStorage.getItem("blockSelected")}));if(localStorage.getItem("blockSelected")&&e){var t=localStorage.getItem("blockSelected");o(+t)}else o(n[0].id)}}),[n]);var q=function(){var e=l()(i.a.mark((function e(){var t,n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),e.next=3,C.d({idBlock:c});case 3:(t=e.sent)&&t.data&&t.data.data&&(n=t.data.data.services,null!==(r=void 0===n?[]:n)?(a=r.map((function(e){return{key:e.id,edit:e.id,idUnit:e.idUnit,nameService:e.nameService,price:e.price,nameUnit:e.nameUnit,description:e.description}})),U(a||[])):U([])),D(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=l()(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.b({id:t});case 2:(n=e.sent)&&(n.data&&n.data.data?(E.a.success("Xóa dịch vụ thành công!"),q()):E.a.error("Xóa dịch vụ thất bại"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(e){if(e){var t=A.find((function(t){return t.key===e}));R(Z(Z({},z),{},{isOpen:!0,serviceEdited:t}))}},Q=function(){var e=l()(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.c({servicesId:m});case 2:(t=e.sent)&&(t.data&&t.data.data?(E.a.success("Xóa thành công"),b([]),q()):E.a.error("Xóa thất bại"));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return f.a.createElement("div",{style:{padding:10}},f.a.createElement(j.a,null,f.a.createElement(w.a,{xs:{span:24,offset:0},md:{span:12,offset:0}},f.a.createElement($,{level:4},"QUẢN LÝ DỊCH VỤ")),f.a.createElement(w.a,{xs:{span:24,offset:0},md:{span:12,offset:0},className:"flex-row",style:{justifyContent:"flex-end"}},f.a.createElement(O.a,{showSearch:!0,value:c,style:{width:200},placeholder:"Chọn khu trọ",onChange:function(e){localStorage.setItem("blockSelected",e),o(e)},optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map((function(e){return f.a.createElement(ee,{key:e.id,value:e.id},e.nameBlock)}))))),f.a.createElement(j.a,{style:{marginTop:20}},f.a.createElement(w.a,{xs:{span:24},md:{span:24},className:"flex-row",style:{justifyContent:"flex-end"}},f.a.createElement(h.a,{disabled:!(n.length>0),type:"primary",className:"flex-row",onClick:function(){H(!0)}},f.a.createElement("i",{className:"icon-add_circle_outlinecontrol_point"}),"   Thêm mới"),"  ",f.a.createElement(g.a,{disabled:!(m.length>0),placement:"bottom",title:"Bạn có muốn xóa ".concat(m.length," dịch vụ này?"),okText:"Xóa",onConfirm:Q,cancelText:"Hủy"},f.a.createElement(h.a,{disabled:!(m.length>0),type:"danger"},f.a.createElement("i",{className:"icon-delete"}),"   Xóa nhiều")))),f.a.createElement(k.a,{spinning:I,tip:"Loading..."},f.a.createElement(j.a,{style:{paddingTop:"10px"}},f.a.createElement(P.a,{size:"small",rowSelection:V,style:{width:"100%"},columns:K,dataSource:A}))),f.a.createElement(F,{isOpen:X,toggleModal:function(){H(!X)},block:n.find((function(e){return e.id===c})),blockServices:A,callback:function(){q()}}),f.a.createElement(W,{isOpen:z.isOpen,service:z.serviceEdited,block:n.find((function(e){return e.id===c})),toggleModal:function(){R(Z(Z({},z),{},{isOpen:!z.isOpen}))},callback:function(){q()}}))};te.propTypes={};var ne={layout:I.c};t.default=Object(b.b)((function(e){return{blocks:e.Layouts.layoutReducer.blocks}}),ne)(te)}}]);
//# sourceMappingURL=14.js.map